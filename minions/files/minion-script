#!/bin/bash
#
# Generated by minions-formula

set -euo pipefail

case ${1-} in
    find-file-roots)
        miniondir={{ deploy_root }}
        echo 'file_roots:'
        basedir=${miniondir}/file_roots/base/
        for envdir in $(echo ${miniondir}/file_roots/*/ | sort) ; do
            env=$(basename ${envdir})
            echo "  ${env}:"
            # Skip base env as it is always rendered just below.
            if [ "${env}" != "base" ] ; then
                echo ${envdir}/*/ | sort | sed 's,^,    - ,'
            fi
            # We always put base/ directory at end of file_roots. This allow
            # dev to push formulas in base/.
            if test -d ${basedir} ; then
                echo ${basedir}/*/ | sort | sed 's,^,    - ,'
            fi
        done
    ;;
    *)
        exec salt-call --config-dir={{ config_dir }} $@
        ;;
esac

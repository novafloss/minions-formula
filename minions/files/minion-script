#!/bin/bash
#
# Generated by minions-formula

set -euo pipefail

case ${1-} in
    find-file-roots)
        miniondir={{ deploy_root }}
        echo 'file_roots:'
        env={{ env }}
        envdir=${miniondir}/file_roots/$env
        basedir=${miniondir}/file_roots/base
        echo "  $env:"
        # Skip base env as it is always rendered just below.
        if [ -d ${envdir} ] ; then
            echo ${envdir}/*/ | sort | sed 's,^,    - ,'
        fi
        # We always put base/ directory at end of file_roots. This allow
        # dev to push formulas in base/.
        if [ -d ${basedir} -a "$env" != "base" ] ; then
            echo ${basedir}/*/ | sort | sed 's,^,    - ,'
        fi

    ;;
    *)
        exec salt-call --config-dir={{ config_dir }} $@
        ;;
esac
